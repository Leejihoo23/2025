import streamlit as st
import datetime
import random

# 앱 기본 설정
st.set_page_config(page_title="별자리 오늘의 운세", page_icon="✨", layout="centered")

# --- 스타일 (CSS) ---
st.markdown(
    """
    <style>
    .title {
        font-size:36px;
        font-weight:800;
        text-align:center;
        color:#9333ea;
    }
    .subtitle {
        font-size:18px;
        text-align:center;
        color:#475569;
    }
    .fortune-box {
        margin-top:20px;
        padding:20px;
        border-radius:12px;
        background:linear-gradient(180deg, #faf5ff, #f3e8ff);
        text-align:center;
        font-size:20px;
        font-weight:600;
        color:#4c1d95;
        box-shadow: 0px 4px 12px rgba(0,0,0,0.08);
    }
    .lucky-box {
        margin-top:15px;
        padding:15px;
        border-radius:10px;
        background:#ecfdf5;
        color:#065f46;
        font-size:18px;
        font-weight:600;
        text-align:center;
    }
    </style>
    """,
    unsafe_allow_html=True,
)

# --- 별자리 계산 함수 ---
def get_zodiac(month, day):
    zodiac_dates = [
        ("물병자리", (1, 20), (2, 18)),
        ("물고기자리", (2, 19), (3, 20)),
        ("양자리", (3, 21), (4, 19)),
        ("황소자리", (4, 20), (5, 20)),
        ("쌍둥이자리", (5, 21), (6, 21)),
        ("게자리", (6, 22), (7, 22)),
        ("사자자리", (7, 23), (8, 22)),
        ("처녀자리", (8, 23), (9, 22)),
        ("천칭자리", (9, 23), (10, 23)),
        ("전갈자리", (10, 24), (11, 22)),
        ("사수자리", (11, 23), (12, 21)),
        ("염소자리", (12, 22), (1, 19)),
    ]

    for zodiac, start, end in zodiac_dates:
        if start[0] == end[0]:
            if month == start[0] and start[1] <= day <= end[1]:
                return zodiac
        else:
            if (month == start[0] and day >= start[1]) or (month == end[0] and day <= end[1]):
                return zodiac
    return None

# --- 별자리별 운세 메시지 ---
zodiac_fortunes = {
    "물병자리": ["새로운 아이디어가 떠오르는 날입니다.", "주변의 도움으로 일이 술술 풀립니다."],
    "물고기자리": ["감성이 풍부해지는 하루입니다.", "누군가의 고마움을 느끼게 될 거예요."],
    "양자리": ["도전이 행운을 불러옵니다.", "열정적인 태도가 좋은 결과를 줍니다."],
    "황소자리": ["안정과 성실함이 빛나는 하루입니다.", "재정적으로 유리한 기회가 올 수 있어요."],
    "쌍둥이자리": ["소통 능력이 돋보이는 날입니다.", "예상치 못한 만남이 기다리고 있습니다."],
    "게자리": ["가족과의 시간이 큰 힘이 됩니다.", "따뜻한 말 한마디가 좋은 결과를 만듭니다."],
    "사자자리": ["자신감을 보일수록 운이 따릅니다.", "리더십이 인정받는 하루입니다."],
    "처녀자리": ["세심함이 좋은 결과를 만듭니다.", "작은 성취가 기쁨을 줍니다."],
    "천칭자리": ["균형 잡힌 선택이 필요합니다.", "주변과 협력하면 행운이 찾아옵니다."],
    "전갈자리": ["열정이 좋은 성과를 가져옵니다.", "깊은 대화가 관계를 더욱 돈독히 합니다."],
    "사수자리": ["모험심이 행운을 불러옵니다.", "여행이나 이동에서 좋은 소식이 있습니다."],
    "염소자리": ["끈기 있는 태도가 결실을 맺습니다.", "노력의 보상이 다가옵니다."],
}

# --- 행운의 아이템 / 색상 ---
lucky_colors = ["파란색", "초록색", "노란색", "보라색", "빨간색", "하얀색", "검은색", "분홍색"]
lucky_items = ["책", "꽃", "커피", "휴대폰", "헤드폰", "노트북", "운동화", "시계", "반지", "가방"]

# --- 헤더 ---
st.markdown("<div class='title'>✨ 별자리 오늘의 운세</div>", unsafe_allow_html=True)
st.markdown("<div class='subtitle'>생일을 입력하고 당신의 별자리와 행운을 확인하세요</div>", unsafe_allow_html=True)

# 사용자 입력
name = st.text_input("이름을 입력하세요")
birth = st.date_input("생일을 입력하세요", value=datetime.date(2000, 1, 1))

btn = st.button("오늘의 운세 보기")

# --- 결과 출력 ---
if btn and name:
    zodiac = get_zodiac(birth.month, birth.day)
    today = datetime.date.today().strftime("%Y-%m-%d")
    st.write(f"### 📅 {today} | 🙋‍♀️ {name}님의 별자리: **{zodiac}**")

    fortune = random.choice(zodiac_fortunes[zodiac])
    color = random.choice(lucky_colors)
    item = random.choice(lucky_items)

    st.markdown(f"<div class='fortune-box'>{fortune}</div>", unsafe_allow_html=True)
    st.markdown(f"<div class='lucky-box'>🎨 행운의 색상: {color} | 🍀 행운의 아이템: {item}</div>", unsafe_allow_html=True)

elif btn and not name:
    st.warning("이름을 입력해주세요!")

